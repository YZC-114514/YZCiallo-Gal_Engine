# **YZCiallo Galgame 引擎劇本編寫指南**

本引擎的設計理念是實現「數據與邏輯分離」，透過讀取純文字檔案來驅動整個遊戲流程。這意味著您不需要編寫任何 Java 程式碼即可創作遊戲。為了確保文字在所有平台上顯示正常，請務必將劇本檔案儲存為 **UTF-8** 編碼格式的 .txt 檔（建議使用 Notepad++ 或 VS Code 等編輯器確認編碼）。所有的指令與參數之間，請嚴格使用英文半形豎線 | 進行分隔，切勿使用全形符號。

## **1\. 指令語法速查**

下表詳細列出了引擎支援的所有指令及其運作機制。為了保持腳本的可讀性與最佳相容性，指令關鍵字（如 BG, GOTO）建議統一使用大寫。

| 功能類別 | 指令格式 | 詳細說明與範例 |
| :---- | :---- | :---- |
| **角色對話** | \`角色 | 表情 |
| **背景切換** | \`BG | 圖片.jpg\` |
| **選項分歧** | \`CHOICE | 文:標,文:標\` |
| **劇情標籤** | \#標籤名 | 定義腳本中的錨點位置。這些行在遊戲執行時是不可見的，引擎會自動跳過並讀取下一行。它們存在的唯一目的是作為 GOTO 或 CHOICE 指令的導航目標。 • *範例*：\#Lib |
| **流程跳轉** | \`GOTO | 標籤名\` |
| **章節切換** | \`NEXT\_CHAPTER | 檔名\` |

## **2\. 資源管理與除錯指南**

為了確保遊戲資源能被程式正確索引與載入，請嚴格遵守以下的檔案命名規範與排錯建議：

### **檔案命名規範**

* **立繪圖片 (Character Sprites)**：  
  * 標準格式必須為 角色名\_表情.jpg (例如：Girl\_happy.jpg)。  
  * **自動備援機制 (Fallback System)**：為了防止因缺少單一表情圖導致遊戲崩潰，若系統找不到 角色名\_表情.jpg，會自動嘗試降級讀取預設圖片 角色名.jpg (如 Girl.jpg)。若連預設圖都找不到，可能會顯示色塊或報錯。  
* **背景圖片 (Backgrounds)**：  
  * 指令中必須包含完整的副檔名 (例如：.jpg 或 .png)。  
  * **大小寫敏感**：在 Java 環境中，bg.jpg 與 BG.jpg 是不同的檔案，請確保腳本與實際檔名完全一致。

### **常見故障排除 (Troubleshooting)**

* **選項按鈕點擊無反應或卡死**：  
  * 這通常是因為找不到跳轉目標。請仔細檢查 CHOICE 指令中的目標標籤名稱（冒號後面的文字）是否與下方的 \#標籤 **完全一致**（包含英文大小寫及有無多餘空格）。  
* **圖片顯示異常（紅塊、空白或全黑）**：  
  * **隱藏副檔名陷阱**：請確認 Windows 作業系統是否開啟了「隱藏已知檔案的副檔名」。你看到的 image.jpg 實際檔名可能是 image.jpg.png，導致程式找不到檔案。  
* **GOTO 跳轉失效**：  
  * 請確認指令參數前後沒有多餘的空格（例如 GOTO | Label 這種寫法可能會導致字串匹配失敗）。建議緊貼豎線書寫指令與參數。  
* **中文顯示亂碼**：  
  * 這是最常見的問題。請確保您的 .txt 文件是使用 **UTF-8** 編碼保存，而非 ANSI 或 Big5。
